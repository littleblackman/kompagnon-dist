import{_ as I}from"./C3JRzAoH.js";import{c as n,o as r,a as e,e as T,u as D,x as q,g as F,f as P,r as j,b as c,h as l,C as M,i as d,t as h,d as U,F as N,k as A,w as E,y as G}from"./Cnx3c5PK.js";import{a as O,u as R}from"./qTv9OuhQ.js";import{P as J}from"./Dwlf1hfH.js";import{P as K}from"./CtxXX87B.js";import{u as Q}from"./DDkLD7eW.js";import{r as W}from"./Bx_xIVoU.js";import{r as X}from"./BbLbQME0.js";import{r as Y}from"./BMrdG8cD.js";import{_ as ee}from"./DlAUqK2U.js";function te(_,x){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.161 14.34 9 15.375 9h1.875A3.75 3.75 0 0 1 21 12.75v3.375C21 17.16 20.16 18 19.125 18h-9.75A1.875 1.875 0 0 1 7.5 16.125V3.375Z"}),e("path",{d:"M15 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 17.25 7.5h-1.875A.375.375 0 0 1 15 7.125V5.25ZM4.875 6H6v10.125A3.375 3.375 0 0 0 9.375 19.5H16.5v1.125c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V7.875C3 6.839 3.84 6 4.875 6Z"})])}function $(_,x){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M5.25 6.375a4.125 4.125 0 1 1 8.25 0 4.125 4.125 0 0 1-8.25 0ZM2.25 19.125a7.125 7.125 0 0 1 14.25 0v.003l-.001.119a.75.75 0 0 1-.363.63 13.067 13.067 0 0 1-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 0 1-.364-.63l-.001-.122ZM18.75 7.5a.75.75 0 0 0-1.5 0v2.25H15a.75.75 0 0 0 0 1.5h2.25v2.25a.75.75 0 0 0 1.5 0v-2.25H21a.75.75 0 0 0 0-1.5h-2.25V7.5Z"})])}const se={key:0},oe={key:1},re={class:"container mx-auto p-6"},ne={class:"mb-8"},ae={class:"mb-4"},le={class:"text-3xl font-bold text-gray-900"},ie={class:"flex justify-between items-center"},ce={key:0,class:"text-center py-12"},ue={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},de={class:"flex justify-between items-start mb-4"},ge={class:"flex items-center gap-3"},ve={class:"w-12 h-12 rounded-full overflow-hidden bg-gray-200 flex-shrink-0"},me=["src","alt"],fe={key:1,class:"w-full h-full flex items-center justify-center text-gray-400"},he={class:"text-xl font-semibold text-gray-900"},pe={key:0,class:"text-sm text-gray-500"},_e={class:"flex gap-2"},xe=["onClick"],ye=["onClick"],be=["onClick"],we={class:"space-y-3"},ke={key:0,class:"flex items-center gap-2"},Ce={class:"flex"},Pe={class:"text-xs text-gray-500"},je={key:1,class:"text-sm text-gray-600"},Me=["innerHTML"],Ne={key:2,class:"text-sm text-gray-600"},Ae=["innerHTML"],$e=T({__name:"personnages-[slug]",setup(_){D().requireAuth();const g=O(),u=R(),v=q().params.slug,{getImageUrl:B,getImagesUrls:S}=Q();F(()=>g.fetchProject(v));const i=P(()=>g.project),f=j(!1),y=j(null),p=(o=null)=>{y.value=o||{firstName:"",lastName:"",background:"",age:null,level:null,analysis:""},f.value=!0},V=async o=>{if(!i.value)return;await u.savePersonnage(o,i.value.id)&&(await g.fetchProject(v),f.value=!1)},H=async o=>{confirm("Êtes-vous sûr de vouloir supprimer ce personnage ? Cette action est irréversible.")&&await u.deletePersonnage(o)&&await g.fetchProject(v)},L=async o=>{if(!i.value)return;const t={...o,id:null,firstName:`${o.firstName} (copie)`,projectId:i.value.id};await u.savePersonnage(t,i.value.id)&&await g.fetchProject(v)},b=o=>u.getPersonnageName(o),w=o=>o?o.avatar?B(o.avatar):S(o.images)[0]||null:null,Z=P(()=>[...u.personnages].sort((o,t)=>{var k,C;const m=o.level||999,s=t.level||999;if(m!==s)return m-s;const a=((k=o.firstName)==null?void 0:k.toLowerCase())||"",z=((C=t.firstName)==null?void 0:C.toLowerCase())||"";return a.localeCompare(z)}));return(o,t)=>{const m=I;return i.value?(r(),n("div",oe,[c(K,{"project-slug":l(v)},null,8,["project-slug"]),e("div",re,[e("div",ne,[e("div",ae,[e("h1",le,"Personnages - "+h(i.value.name),1)]),e("div",ie,[t[4]||(t[4]=e("p",{class:"text-gray-600"},"Gérez les personnages de votre projet",-1)),e("button",{onClick:t[0]||(t[0]=s=>p()),class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"},[c(l($),{class:"w-4 h-4"}),t[3]||(t[3]=U(" Nouveau personnage "))])])]),l(u).personnages.length===0?(r(),n("div",ce,[c(l($),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[5]||(t[5]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucun personnage",-1)),t[6]||(t[6]=e("p",{class:"text-gray-500 mb-4"},"Commencez par créer votre premier personnage",-1)),e("button",{onClick:t[1]||(t[1]=s=>p()),class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors"}," Créer un personnage ")])):(r(),n("div",ue,[(r(!0),n(N,null,A(Z.value,s=>(r(),n("div",{key:s.id,class:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition-shadow"},[e("div",de,[e("div",ge,[e("div",ve,[w(s)?(r(),n("img",{key:0,src:w(s),alt:b(s),class:"w-full h-full object-cover"},null,8,me)):(r(),n("div",fe,[c(l(W),{class:"w-6 h-6"})]))]),e("div",null,[e("h3",he,h(b(s)),1),s.age?(r(),n("p",pe,h(s.age)+" ans",1)):d("",!0)])]),e("div",_e,[s.slug?(r(),M(m,{key:0,to:`/projets/detail-${s.slug}`,class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Voir les détails",onClick:a=>console.log("Navigating to:",s.slug,s)},{default:E(()=>t[7]||(t[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])),_:2},1032,["to","onClick"])):d("",!0),e("button",{onClick:a=>p(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Modifier"},[c(l(X),{class:"w-4 h-4"})],8,xe),e("button",{onClick:a=>L(s),class:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:"Dupliquer"},[c(l(te),{class:"w-4 h-4"})],8,ye),e("button",{onClick:a=>H(s.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Supprimer"},[c(l(Y),{class:"w-4 h-4"})],8,be)])]),e("div",we,[s.level?(r(),n("div",ke,[t[8]||(t[8]=e("span",{class:"text-sm font-medium text-gray-700"},"Niveau :",-1)),e("div",Ce,[(r(),n(N,null,A(5,a=>e("span",{key:a,class:G(["w-3 h-3 rounded-full mr-1",a<=6-s.level?"bg-yellow-400":"bg-gray-200"])},null,2)),64))]),e("span",Pe,"("+h(s.level)+")",1)])):d("",!0),s.background?(r(),n("div",je,[t[9]||(t[9]=e("span",{class:"font-medium"},"Background :",-1)),e("div",{innerHTML:s.background.substring(0,100)+(s.background.length>100?"...":""),class:"mt-1"},null,8,Me)])):d("",!0),s.analysis?(r(),n("div",Ne,[t[10]||(t[10]=e("span",{class:"font-medium"},"Analyse :",-1)),e("div",{innerHTML:s.analysis.substring(0,100)+(s.analysis.length>100?"...":""),class:"mt-1"},null,8,Ae)])):d("",!0)])]))),128))])),f.value?(r(),M(J,{key:2,personnage:y.value||void 0,onClose:t[2]||(t[2]=s=>f.value=!1),onSave:V},null,8,["personnage"])):d("",!0)])])):(r(),n("div",se,"Chargement..."))}}}),Fe=ee($e,[["__scopeId","data-v-d30cdcd7"]]);export{Fe as default};
