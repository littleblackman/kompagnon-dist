import{e as M,u as z,f as k,r as u,g as D,c as o,b as O,a as e,i as g,F as p,k as h,t as n,d as S,j as R,s as I,x as V,o as r,y as f,z as q}from"./DDbqB2VL.js";import{useMetadataStore as U}from"./Buzi5y1C.js";import{P as A}from"./BlRu_04W.js";import{_ as L}from"./DlAUqK2U.js";import"./DKoE4HND.js";import"./BTMoKPNP.js";import"./BqMwdbGL.js";const H={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},K={class:"space-y-6"},Q={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},X={class:"overflow-x-auto pb-4 -mx-6 px-6"},J={class:"flex gap-4 min-w-max"},W=["onClick"],Y={class:"text-4xl mb-3 text-center"},Z={class:"font-medium text-gray-900 text-center mb-2"},ee={class:"text-xs text-gray-500 text-center line-clamp-2"},te={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},se={class:"flex items-center mb-4"},ae={class:"text-xl font-semibold text-gray-900"},oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},re=["onClick"],ne={class:"font-medium text-gray-900"},le={class:"text-xs text-gray-500 mt-1"},ie={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},de={class:"overflow-x-auto pb-4 -mx-6 px-6"},ce={class:"flex gap-4 min-w-max"},ue=["onClick"],me={class:"absolute top-3 right-3 px-3 py-1 bg-gradient-to-r from-amber-500 to-orange-500 text-white text-sm font-bold rounded-full"},ge={key:0,class:"absolute top-3 left-3 px-2 py-0.5 bg-blue-500 text-white text-xs font-bold rounded"},ve={class:"font-bold text-gray-900 mb-2 mt-2 text-center"},be={class:"text-xs text-gray-500 text-center mb-3 line-clamp-3"},xe={class:"text-xs text-amber-600 font-medium text-center"},pe={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},he={class:"flex items-center mb-6"},fe={class:"text-sm text-gray-500"},_e={class:"space-y-2"},ye={class:"flex items-start gap-3"},we={class:"flex-shrink-0 w-8 h-8 bg-amber-500 text-white rounded-full flex items-center justify-center text-sm font-bold"},ke={class:"flex-1 min-w-0"},Se={class:"flex items-center gap-2 mb-1"},Ce={class:"font-medium text-gray-900"},$e={key:0,class:"px-2 py-0.5 text-xs bg-amber-100 text-amber-700 rounded"},je={class:"text-sm text-gray-600"},Ne={key:3,class:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-lg border-2 border-amber-200 p-6"},Pe={class:"text-center"},Te=["disabled"],Fe={key:0},Ge={key:1},Be=M({__name:"aide-creation-[slug]",setup(Ee){const C=V(),$=I(),d=U(),j=z(),N=q(),y=k(()=>C.params.slug),b=u(!1),v=u(null),x=u(null),c=u(null),P=k(()=>(console.log("üîç DEBUG genres from store:",d.genres),d.genres.map(a=>({...a,icon:T(a.name)})))),i=u([]),m=u([]),_=u([]),T=a=>({Thriller:"üî™",Romance:"üíï",Fantasy:"‚öîÔ∏è","Science-Fiction":"üöÄ",Myst√®re:"üîç",Drame:"üé≠"})[a]||"üìö",F=a=>{v.value=a,x.value=null,c.value=null,i.value=[],m.value=[],_.value=[]},G=async a=>{x.value=a,c.value=null,i.value=[],m.value=[],console.log(`üìã Subgenre "${a.name}" s√©lectionn√© (ID: ${a.id})`);try{const t=await $fetch(`${N.public.apiBase}/subgenre/${a.id}`,{headers:{"X-AUTH-TOKEN":j.token||""}});m.value=t.narrativeStructures||[],_.value=t.dramaticFunctions||[],console.log(`‚úÖ ${m.value.length} structures narratives charg√©es`),console.log(`‚úÖ ${_.value.length} fonctions dramatiques charg√©es`)}catch(t){console.error("‚ùå Erreur lors du chargement du subgenre:",t)}},B=a=>{c.value=a,console.log(`
=== S√âLECTION STRUCTURE ===`),console.log("Structure:",a.name,`(${a.recommendedPercentage}%)`),i.value=a.events||[],console.log(`üìã ${i.value.length} √©v√©nements charg√©s`),console.log("Ordre:",i.value.map(t=>`${t.position}. ${t.name}${t.isOptional?" (opt)":""}`)),console.log(`=== FIN ===
`)},E=async()=>{b.value=!0;try{await new Promise(a=>setTimeout(a,2e3)),$.push(`/projets/projet-${y.value}`)}catch(a){console.error("Erreur lors de la g√©n√©ration:",a)}finally{b.value=!1}};return D(async()=>{console.log("üöÄ Page mont√©e, metadata loaded?",d.loaded),console.log("üöÄ Genres au montage:",d.genres.length),d.loaded||(console.log("‚è≥ Chargement des metadata..."),await d.fetchMetadata(),console.log("‚úÖ Metadata charg√©es, genres:",d.genres.length))}),(a,t)=>(r(),o("div",null,[O(A,{"project-slug":y.value},null,8,["project-slug"]),e("div",H,[t[8]||(t[8]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," üå≥ Aide √† la cr√©ation de structure "),e("p",{class:"text-gray-600"}," Laissez-vous guider pour cr√©er la structure narrative de votre projet ")],-1)),e("div",K,[e("div",Q,[t[0]||(t[0]=e("div",{class:"flex items-center mb-4"},[e("div",{class:"w-10 h-10 bg-amber-500 text-white rounded-full flex items-center justify-center font-bold mr-3"}," 1 "),e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-900"},"Quel genre d'histoire ?"),e("p",{class:"text-sm text-gray-500"},"S√©lectionnez un genre")])],-1)),e("div",X,[e("div",J,[(r(!0),o(p,null,h(P.value,s=>{var l;return r(),o("button",{key:s.id,onClick:w=>F(s),class:f(["flex-shrink-0 w-48 p-6 border-2 rounded-lg hover:border-amber-500 hover:bg-amber-50 transition-all",((l=v.value)==null?void 0:l.id)===s.id?"border-amber-500 bg-amber-50":"border-gray-200"])},[e("div",Y,n(s.icon),1),e("div",Z,n(s.name),1),e("div",ee,n(s.description),1)],10,W)}),128))])])]),v.value?(r(),o("div",te,[e("div",se,[t[2]||(t[2]=e("div",{class:"w-10 h-10 bg-amber-500 text-white rounded-full flex items-center justify-center font-bold mr-3"}," 2 ",-1)),e("div",null,[e("h2",ae,"Type de "+n(v.value.name)+" ?",1),t[1]||(t[1]=e("p",{class:"text-sm text-gray-500"},"Choisissez un sous-genre",-1))])]),e("div",oe,[(r(!0),o(p,null,h(v.value.subgenres,s=>{var l;return r(),o("button",{key:s.id,onClick:w=>G(s),class:f(["p-4 border-2 rounded-lg hover:border-amber-500 hover:bg-amber-50 transition-all text-left",((l=x.value)==null?void 0:l.id)===s.id?"border-amber-500 bg-amber-50":"border-gray-200"])},[e("div",ne,n(s.name),1),e("div",le,n(s.description),1)],10,re)}),128))])])):g("",!0),x.value&&m.value.length>0?(r(),o("div",ie,[t[3]||(t[3]=e("div",{class:"flex items-center mb-4"},[e("div",{class:"w-10 h-10 bg-amber-500 text-white rounded-full flex items-center justify-center font-bold mr-3"}," 3 "),e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-900"},"Structures narratives recommand√©es"),e("p",{class:"text-sm text-gray-500"},"S√©lectionnez une structure (class√©es par compatibilit√©)")])],-1)),e("div",de,[e("div",ce,[(r(!0),o(p,null,h(m.value,s=>{var l;return r(),o("button",{key:s.id,onClick:w=>B(s),class:f(["flex-shrink-0 w-64 p-6 border-2 rounded-lg hover:border-amber-500 hover:bg-amber-50 transition-all relative",((l=c.value)==null?void 0:l.id)===s.id?"border-amber-500 bg-amber-50":"border-gray-200"])},[e("div",me,n(s.recommendedPercentage)+"% ",1),s.isDefault?(r(),o("div",ge," ‚≠ê D√©faut ")):g("",!0),e("div",ve,n(s.name),1),e("div",be,n(s.description),1),e("div",xe," üìç "+n(s.totalBeats)+" points pivots ",1)],10,ue)}),128))])])])):g("",!0),c.value&&i.value.length>0?(r(),o("div",pe,[e("div",he,[t[6]||(t[6]=e("div",{class:"w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold mr-3"}," 4 ",-1)),e("div",null,[t[5]||(t[5]=e("h2",{class:"text-xl font-semibold text-gray-900"},"√âv√©nements narratifs",-1)),e("p",fe,[t[4]||(t[4]=S(" Structure : ")),e("strong",null,n(c.value.name),1),S(" ‚Ä¢ "+n(i.value.length)+" √©v√©nement(s) ",1)])])]),e("div",_e,[(r(!0),o(p,null,h(i.value,(s,l)=>(r(),o("div",{key:s.id,class:f(["p-4 rounded-lg border-2 transition-all",s.isOptional?"bg-gray-50 border-gray-200":"bg-white border-gray-300"])},[e("div",ye,[e("div",we,n(s.position||l+1),1),e("div",ke,[e("div",Se,[e("div",Ce,n(s.name),1),s.isOptional?(r(),o("span",$e," optionnel ")):g("",!0)]),e("div",je,n(s.description),1)])])],2))),128))])])):g("",!0),c.value?(r(),o("div",Ne,[e("div",Pe,[t[7]||(t[7]=R('<h3 class="text-xl font-semibold text-gray-900 mb-2" data-v-ae8473ca>Pr√™t √† g√©n√©rer votre structure ?</h3><p class="text-gray-600 mb-6" data-v-ae8473ca> Bas√© sur vos choix, nous allons cr√©er automatiquement : </p><div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-left" data-v-ae8473ca><div class="bg-white rounded-lg p-4" data-v-ae8473ca><div class="font-medium text-gray-900 mb-1" data-v-ae8473ca>üìö Structure narrative</div><div class="text-sm text-gray-600" data-v-ae8473ca>Parts et s√©quences organis√©es</div></div><div class="bg-white rounded-lg p-4" data-v-ae8473ca><div class="font-medium text-gray-900 mb-1" data-v-ae8473ca>üë• Personnages essentiels</div><div class="text-sm text-gray-600" data-v-ae8473ca>Fonctions dramatiques assign√©es</div></div><div class="bg-white rounded-lg p-4" data-v-ae8473ca><div class="font-medium text-gray-900 mb-1" data-v-ae8473ca>üé¨ √âv√©nements cl√©s</div><div class="text-sm text-gray-600" data-v-ae8473ca>Moments de bascule positionn√©s</div></div></div>',3)),e("button",{onClick:E,disabled:b.value,class:"px-8 py-3 bg-amber-500 text-white font-semibold rounded-lg hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[b.value?(r(),o("span",Fe,"‚è≥ G√©n√©ration en cours...")):(r(),o("span",Ge,"‚ú® G√©n√©rer la structure"))],8,Te)])])):g("",!0)])])]))}}),qe=L(Be,[["__scopeId","data-v-ae8473ca"]]);export{qe as default};
