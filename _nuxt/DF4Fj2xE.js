import{e as D,g as P,f as M,r as m,c as i,a as t,t as d,l as C,i as h,m as _,v as N,D as F,F as B,k as z,b as w,d as T,h as U,s as q,o as n}from"./DDbqB2VL.js";import{a as L}from"./BTMoKPNP.js";import{useMetadataStore as $}from"./Buzi5y1C.js";import{_ as I}from"./DKTG0W-z.js";import{r as R}from"./B7bbH5_N.js";import{_ as A}from"./DlAUqK2U.js";const G={class:"w-1/2 flex flex-col items-center p-6"},H={class:"text-2xl font-bold mb-6"},J={class:"grid grid-cols-2 gap-4"},K=["value"],O={key:0,class:"text-red-600 text-sm"},Q={class:"flex gap-4"},W=["disabled"],X=["disabled"],Y=D({__name:"ProjectForm",props:{isEdit:{type:Boolean},project:{}},setup(S){var y,g,j,x;const s=S,b=q(),f=L(),v=$();P(()=>{v.loaded||v.fetchMetadata()});const k=M(()=>v.types),r=m({name:((y=s.project)==null?void 0:y.name)||"",description:((g=s.project)==null?void 0:g.description)||"",type_id:((x=(j=s.project)==null?void 0:j.type)==null?void 0:x.id)||null}),u=m(!1),l=m(""),p=m(!1),E=async()=>{var a;if(!r.value.name||!r.value.type_id){l.value="Veuillez remplir tous les champs obligatoires";return}u.value=!0,l.value="";try{let e;s.isEdit&&((a=s.project)!=null&&a.id)?e=await f.updateProject({id:s.project.id,...r.value}):e=await f.createProject(r.value),e.slug&&b.push(`/projets/projet-${e.slug}`)}catch(e){console.error("Erreur lors de la sauvegarde:",e),l.value="Erreur lors de la sauvegarde du projet"}finally{u.value=!1}},V=async()=>{var e;if(!(!((e=s.project)!=null&&e.id)||!confirm("Êtes-vous sûr de vouloir supprimer ce projet ? Cette action est irréversible."))){p.value=!0,l.value="";try{await f.deleteProject(s.project.id),b.push("/projets/tous")}catch(c){console.error("Erreur lors de la suppression:",c),l.value="Erreur lors de la suppression du projet"}finally{p.value=!1}}};return(a,e)=>{var c;return n(),i("div",G,[t("h1",H,d(a.isEdit?"Paramètres":"Créer un nouveau projet"),1),t("form",{onSubmit:C(E,["prevent"]),class:"w-full"},[t("div",J,[t("div",null,[e[3]||(e[3]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-2"}," Nom * ",-1)),_(t("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>r.value.name=o),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500",placeholder:"Nom"},null,512),[[N,r.value.name]])]),t("div",null,[e[5]||(e[5]=t("label",{for:"type",class:"block text-sm font-medium text-gray-700 mb-2"}," Type * ",-1)),_(t("select",{id:"type","onUpdate:modelValue":e[1]||(e[1]=o=>r.value.type_id=o),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500"},[e[4]||(e[4]=t("option",{value:""},"Sélectionnez un type",-1)),(n(!0),i(B,null,z(k.value,o=>(n(),i("option",{key:o.id,value:o.id},d(o.name),9,K))),128))],512),[[F,r.value.type_id]])])]),t("div",null,[e[6]||(e[6]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-2"}," Description ",-1)),w(I,{modelValue:r.value.description,"onUpdate:modelValue":e[2]||(e[2]=o=>r.value.description=o),placeholder:"Décrivez votre projet...",height:120},null,8,["modelValue"])]),l.value?(n(),i("div",O,d(l.value),1)):h("",!0),t("div",Q,[t("button",{type:"submit",disabled:u.value,class:"flex-1 bg-amber-600 text-white py-2 px-4 rounded-md hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-500 disabled:opacity-50"},d(u.value?"Sauvegarde...":a.isEdit?"Mettre à jour":"Créer le projet"),9,W),a.isEdit&&((c=a.project)!=null&&c.id)?(n(),i("button",{key:0,type:"button",onClick:V,disabled:p.value,class:"flex items-center gap-2 bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50"},[w(U(R),{class:"w-4 h-4"}),T(" "+d(p.value?"Suppression...":"Supprimer"),1)],8,X)):h("",!0)])],32)])}}}),ae=A(Y,[["__scopeId","data-v-0bf9be08"]]);export{ae as P};
